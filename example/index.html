<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
    <head>
        <!-- Global Metas -->
        <meta charset="utf-8">
        <meta name="description" content="">
        <meta name="author" content="">
        <meta name="keywords" content="">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <title>spacebro-client ðŸŒŸ test</title>

        <!-- Mobile Specific Metas -->
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
 
        <!--[if lt IE 9]> HTML5Shiv
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- CSS's -->
        <link rel="stylesheet" href="">

        <!-- Favicons -->
    </head>
    <body>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
      <script src="https://wzrd.in/standalone/socketio-wildcard@latest"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/js-signals/1.0.0/js-signals.min.js"></script>
      <script src="http://localhost:9966/dist/spacebro-client.min.js"></script>
      <script>
        'use strict';

        var spaceBro = window.spacebroClient
        var startTime = null;
        var nowmore = null;
        
        spaceBro.connect('spacebro.space', 3333, {
          clientName: 'pinger',
          channelName: 'pegasus',
          //packers: [{ handler: args => console.log(args.eventName, '=>', args.data) }],
          unpackers: [{ handler: function handler(args) {
              var latency = Date.now() - startTime;
              console.log('Delay: ' + latency);
              //console.log(args.eventName, '<=', args.data) 
            }
          }],
          verbose: true
        });

        spaceBro.on('pongy', function (data) {
          console.log('get ponged:', data.count);
        });

        var count = 0;
        setInterval(function () {
          startTime = Date.now();
          spaceBro.emit('pingy', {
            count: ++count
          });
        }, 2000);
      </script>
    </body>
</html>